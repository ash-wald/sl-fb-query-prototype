<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>F&B Query Filter Prototype</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üçï</text></svg>">
</head>
<body>
    <div id="root">
        <div style="padding: 20px; text-align: center;">
            <p>Loading prototype...</p>
        </div>
    </div>

    <script type="text/babel">
        const { useState, useMemo } = React;

        // Simple SVG icons
        const Search = () => React.createElement('svg', { width: "20", height: "20", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2" },
            React.createElement('circle', { cx: "11", cy: "11", r: "8" }),
            React.createElement('path', { d: "21 21l-4.35-4.35" })
        );

        const Filter = () => React.createElement('svg', { width: "20", height: "20", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2" },
            React.createElement('polygon', { points: "22,3 2,3 10,12.46 10,19 14,21 14,12.46" })
        );

        const Database = () => React.createElement('svg', { width: "24", height: "24", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2" },
            React.createElement('ellipse', { cx: "12", cy: "5", rx: "9", ry: "3" }),
            React.createElement('path', { d: "M21 12c0 1.66-4 3-9 3s-9-1.34-9-3" }),
            React.createElement('path', { d: "M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5" })
        );

        const Utensils = () => React.createElement('svg', { width: "20", height: "20", viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2" },
            React.createElement('path', { d: "M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2" }),
            React.createElement('path', { d: "M7 2v20" }),
            React.createElement('path', { d: "M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3z" })
        );

        const FoodQueryPrototype = () => {
            const [userQuery, setUserQuery] = useState('');

            // Real Cubs concessions data
            const mockFoodData = [
                {
                    item_id: "cubs_1",
                    name: "Chicago Style Hot Dog",
                    description: "Classic Chicago-style hot dog with all the fixings",
                    image_url: "https://example.com/chicago-hotdog.jpg",
                    website_url: "https://cubs.com/concessions/chicago-dogs",
                    location: { section: "108", stand_name: "Chicago Dogs", zone: "Left Field" },
                    category: "Hot Dogs",
                    dietary_info: { allergens: ["Wheat"], dietary_tags: [], is_healthy: false },
                    speed_metadata: { estimated_wait: "Medium", prep_time: "Standard" },
                    popularity: { popularity_score: 9, is_signature: true, customer_favorite: true },
                    pricing: { price_range: "$$", average_price: 12 },
                    custom_tags: ["local specialty", "ballpark classic"],
                    start_date: "2025-03-15",
                    end_date: "2025-10-31"
                },
                {
                    item_id: "cubs_2",
                    name: "Home Run Inn Pizza",
                    description: "Authentic Chicago thin crust pizza slice",
                    image_url: "https://example.com/pizza.jpg",
                    website_url: "https://cubs.com/concessions/pizza",
                    location: { section: "103", stand_name: "Pizza Stand", zone: "Left Field" },
                    category: "Pizza",
                    dietary_info: { allergens: ["Milk", "Wheat"], dietary_tags: [], is_healthy: false },
                    speed_metadata: { estimated_wait: "Medium", prep_time: "Standard" },
                    popularity: { popularity_score: 8, is_signature: true, customer_favorite: true },
                    pricing: { price_range: "$$", average_price: 14 },
                    custom_tags: ["Chicago favorite"],
                    start_date: "2025-03-15",
                    end_date: "2025-10-31"
                },
                {
                    item_id: "cubs_3",
                    name: "Plant Based NotCo Burger",
                    description: "Plant-based burger with vegan cheese and fixings",
                    image_url: "https://example.com/vegan-burger.jpg",
                    website_url: "https://cubs.com/concessions/plant-based",
                    location: { section: "110", stand_name: "Third Base Classics", zone: "Third Base Side" },
                    category: "Burgers",
                    dietary_info: { allergens: ["Wheat"], dietary_tags: ["vegetarian", "vegan", "healthy"], is_healthy: true },
                    speed_metadata: { estimated_wait: "Long", prep_time: "Slow" },
                    popularity: { popularity_score: 7, is_signature: false, customer_favorite: false },
                    pricing: { price_range: "$$$", average_price: 18 },
                    custom_tags: ["eco-friendly", "plant-based"],
                    start_date: "2025-04-01",
                    end_date: "2025-09-30"
                },
                {
                    item_id: "cubs_4",
                    name: "Garrett Mix Popcorn",
                    description: "Famous Chicago mix of cheese and caramel popcorn",
                    image_url: "https://example.com/garrett-popcorn.jpg",
                    website_url: "https://cubs.com/concessions/garrett-popcorn",
                    location: { section: "119", stand_name: "Chicago Dogs", zone: "Right Field" },
                    category: "Popcorn",
                    dietary_info: { allergens: ["Milk", "Soy"], dietary_tags: [], is_healthy: false },
                    speed_metadata: { estimated_wait: "Short", prep_time: "Fast" },
                    popularity: { popularity_score: 9, is_signature: true, customer_favorite: true },
                    pricing: { price_range: "$", average_price: 8 },
                    custom_tags: ["local specialty", "Chicago famous"],
                    start_date: "2025-03-15",
                    end_date: "2025-10-31"
                },
                {
                    item_id: "cubs_5",
                    name: "Vienna Italian Beef Sandwich",
                    description: "Classic Chicago Italian beef sandwich",
                    image_url: "https://example.com/italian-beef.jpg",
                    website_url: "https://cubs.com/concessions/italian-beef",
                    location: { section: "110", stand_name: "Third Base Classics", zone: "Third Base Side" },
                    category: "Italian",
                    dietary_info: { allergens: ["Soy"], dietary_tags: [], is_healthy: false },
                    speed_metadata: { estimated_wait: "Long", prep_time: "Slow" },
                    popularity: { popularity_score: 8, is_signature: true, customer_favorite: true },
                    pricing: { price_range: "$$$", average_price: 16 },
                    custom_tags: ["local specialty", "Chicago tradition"],
                    start_date: "2025-03-15",
                    end_date: "2025-10-31"
                },
                {
                    item_id: "cubs_6",
                    name: "Nachos",
                    description: "Loaded nachos with cheese, jalape√±os, and salsa",
                    image_url: "https://example.com/nachos.jpg",
                    website_url: "https://cubs.com/concessions/nachos",
                    location: { section: "105", stand_name: "Left Field Classics", zone: "Left Field" },
                    category: "Nachos",
                    dietary_info: { allergens: ["Milk"], dietary_tags: ["vegetarian"], is_healthy: false },
                    speed_metadata: { estimated_wait: "Short", prep_time: "Fast" },
                    popularity: { popularity_score: 7, is_signature: false, customer_favorite: true },
                    pricing: { price_range: "$$", average_price: 10 },
                    custom_tags: ["shareable"],
                    start_date: "2025-03-15",
                    end_date: "2025-10-31"
                }
            ];

            // Intent classification logic
            const classifyIntent = (query) => {
                const lowerQuery = query.toLowerCase();
                const intents = [];
                const filters = {};

                // Location-based intent
                const locationKeywords = ['near', 'section', 'gate', 'field', 'close', 'by'];
                const sectionMatch = lowerQuery.match(/section\s*(\d+)/);
                const zoneKeywords = {
                    'left field': 'Left Field',
                    'right field': 'Right Field', 
                    'first base': 'First Base Side',
                    'third base': 'Third Base Side'
                };

                if (locationKeywords.some(keyword => lowerQuery.includes(keyword)) || sectionMatch) {
                    intents.push('location_based');
                    if (sectionMatch) {
                        filters.section = sectionMatch[1];
                    }
                    Object.keys(zoneKeywords).forEach(keyword => {
                        if (lowerQuery.includes(keyword)) {
                            filters.zone = zoneKeywords[keyword];
                        }
                    });
                }

                // Dietary-based intent
                const dietaryKeywords = {
                    'vegetarian': 'vegetarian',
                    'vegan': 'vegan', 
                    'healthy': 'healthy'
                };
                
                Object.keys(dietaryKeywords).forEach(keyword => {
                    if (lowerQuery.includes(keyword)) {
                        intents.push('dietary_based');
                        filters.dietary = dietaryKeywords[keyword];
                    }
                });

                // Speed-based intent
                const speedKeywords = ['fast', 'quick', 'no line', 'short wait', 'fastest'];
                if (speedKeywords.some(keyword => lowerQuery.includes(keyword))) {
                    intents.push('speed_based');
                    filters.speed = 'fast';
                }

                // Popularity-based intent
                const popularityKeywords = ['popular', 'best', 'favorite', 'recommended', 'signature'];
                if (popularityKeywords.some(keyword => lowerQuery.includes(keyword))) {
                    intents.push('popularity_based');
                    filters.popularity = 'high';
                }

                // Category-based intent
                const categoryKeywords = {
                    'pizza': 'Pizza',
                    'hot dog': 'Hot Dogs',
                    'burger': 'Burgers',
                    'nachos': 'Nachos',
                    'ice cream': 'Ice Cream',
                    'popcorn': 'Popcorn'
                };

                Object.keys(categoryKeywords).forEach(keyword => {
                    if (lowerQuery.includes(keyword)) {
                        intents.push('category_based');
                        filters.category = categoryKeywords[keyword];
                    }
                });

                return { intents, filters };
            };

            // Filter and rank results
            const processQuery = (query, data) => {
                const { intents, filters } = classifyIntent(query);
                
                let results = [...data];
                let matchReasons = [];

                // Apply filters
                if (filters.section) {
                    results = results.filter(item => item.location.section === filters.section);
                    matchReasons.push(`Location: Section ${filters.section}`);
                }

                if (filters.zone) {
                    results = results.filter(item => item.location.zone === filters.zone);
                    matchReasons.push(`Zone: ${filters.zone}`);
                }

                if (filters.dietary) {
                    results = results.filter(item => {
                        if (filters.dietary === 'healthy') return item.dietary_info.is_healthy;
                        return item.dietary_info.dietary_tags.includes(filters.dietary);
                    });
                    matchReasons.push(`Dietary: ${filters.dietary}`);
                }

                if (filters.speed === 'fast') {
                    results = results.filter(item => item.speed_metadata.estimated_wait === 'Short');
                    matchReasons.push('Fast service');
                }

                if (filters.category) {
                    results = results.filter(item => item.category === filters.category);
                    matchReasons.push(`Category: ${filters.category}`);
                }

                // Ranking logic
                if (filters.popularity === 'high') {
                    results.sort((a, b) => b.popularity.popularity_score - a.popularity.popularity_score);
                    matchReasons.push('Popular items');
                }

                return {
                    intents,
                    filters,
                    results: results.slice(0, 5),
                    total_results: results.length,
                    match_reasons: matchReasons
                };
            };

            const queryResults = useMemo(() => {
                if (!userQuery.trim()) return null;
                return processQuery(userQuery, mockFoodData);
            }, [userQuery]);

            const sampleQueries = [
                "What vegetarian food is near section 108?",
                "What's the fastest food option?", 
                "Popular food at left field",
                "Chicago style hot dogs",
                "Signature items at Wrigley"
            ];

            return React.createElement('div', { className: "max-w-7xl mx-auto p-6 bg-gray-50 min-h-screen" },
                // Header
                React.createElement('div', { className: "mb-8" },
                    React.createElement('h1', { className: "text-3xl font-bold text-gray-900 mb-2 flex items-center gap-2" },
                        React.createElement(Database),
                        "F&B Query Filter Prototype"
                    ),
                    React.createElement('p', { className: "text-gray-600" },
                        "Demonstrate how user queries translate to search filters and results (using real Cubs data)"
                    )
                ),

                // Query Input
                React.createElement('div', { className: "bg-white rounded-lg shadow-md p-6 mb-6" },
                    React.createElement('label', { className: "block text-sm font-medium text-gray-700 mb-2" },
                        "User Query"
                    ),
                    React.createElement('div', { className: "relative" },
                        React.createElement('div', { className: "absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400" },
                            React.createElement(Search)
                        ),
                        React.createElement('input', {
                            type: "text",
                            value: userQuery,
                            onChange: (e) => setUserQuery(e.target.value),
                            placeholder: "Try: 'What vegetarian food is near section 108?'",
                            className: "w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        })
                    ),
                    React.createElement('div', { className: "mt-4" },
                        React.createElement('p', { className: "text-sm text-gray-600 mb-2" }, "Try these sample queries:"),
                        React.createElement('div', { className: "flex flex-wrap gap-2" },
                            sampleQueries.map((query, index) =>
                                React.createElement('button', {
                                    key: index,
                                    onClick: () => setUserQuery(query),
                                    className: "px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm hover:bg-blue-200 transition-colors"
                                }, query)
                            )
                        )
                    )
                ),

                // Results section
                queryResults && React.createElement('div', null,
                    // Intent Analysis
                    React.createElement('div', { className: "bg-white rounded-lg shadow-md p-6 mb-6" },
                        React.createElement('h2', { className: "text-xl font-semibold mb-4 flex items-center gap-2" },
                            React.createElement(Filter),
                            "Intent Analysis & Filters"
                        ),
                        React.createElement('div', { className: "grid md:grid-cols-2 gap-6" },
                            React.createElement('div', null,
                                React.createElement('h3', { className: "font-medium text-gray-900 mb-2" }, "Detected Intents:"),
                                React.createElement('div', { className: "space-y-1" },
                                    queryResults.intents.map((intent, index) =>
                                        React.createElement('span', {
                                            key: index,
                                            className: "inline-block px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm mr-2 mb-1"
                                        }, intent.replace('_', ' '))
                                    )
                                )
                            ),
                            React.createElement('div', null,
                                React.createElement('h3', { className: "font-medium text-gray-900 mb-2" }, "Applied Filters:"),
                                React.createElement('div', { className: "space-y-1" },
                                    Object.entries(queryResults.filters).map(([key, value]) =>
                                        React.createElement('div', { key: key, className: "text-sm" },
                                            React.createElement('span', { className: "font-medium text-gray-700" }, key + ":"),
                                            React.createElement('span', { className: "ml-1 px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs" }, value)
                                        )
                                    )
                                )
                            )
                        )
                    ),

                    // Results Table
                    React.createElement('div', { className: "bg-white rounded-lg shadow-md p-6" },
                        React.createElement('div', { className: "flex items-center justify-between mb-4" },
                            React.createElement('h2', { className: "text-xl font-semibold flex items-center gap-2" },
                                React.createElement(Utensils),
                                `Query Results (${queryResults.total_results} found)`
                            ),
                            React.createElement('span', { className: "text-sm text-gray-600" },
                                `Showing top ${queryResults.results.length} results`
                            )
                        ),

                        queryResults.results.length > 0 ? 
                            React.createElement('div', { className: "overflow-x-auto" },
                                React.createElement('table', { className: "min-w-full divide-y divide-gray-200" },
                                    React.createElement('thead', { className: "bg-gray-50" },
                                        React.createElement('tr', null,
                                            React.createElement('th', { className: "px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" }, "Item Name"),
                                            React.createElement('th', { className: "px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" }, "Description"),
                                            React.createElement('th', { className: "px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" }, "Image URL"),
                                            React.createElement('th', { className: "px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" }, "Website URL"),
                                            React.createElement('th', { className: "px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" }, "Section"),
                                            React.createElement('th', { className: "px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" }, "Stand Name"),
                                            React.createElement('th', { className: "px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" }, "Allergens/Dietary"),
                                            React.createElement('th', { className: "px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" }, "Price"),
                                            React.createElement('th', { className: "px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" }, "Popularity"),
                                            React.createElement('th', { className: "px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" }, "Wait Time"),
                                            React.createElement('th', { className: "px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" }, "Custom Tags"),
                                            React.createElement('th', { className: "px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" }, "Start Date"),
                                            React.createElement('th', { className: "px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider" }, "End Date")
                                        )
                                    ),
                                    React.createElement('tbody', { className: "bg-white divide-y divide-gray-200" },
                                        queryResults.results.map((item, index) =>
                                            React.createElement('tr', { key: item.item_id, className: "hover:bg-gray-50" },
                                                React.createElement('td', { className: "px-3 py-4 whitespace-nowrap text-sm font-medium text-gray-900" }, item.name),
                                                React.createElement('td', { className: "px-3 py-4 text-sm text-gray-900 max-w-xs" },
                                                    React.createElement('div', { className: "truncate", title: item.description }, item.description)
                                                ),
                                                React.createElement('td', { className: "px-3 py-4 text-sm text-blue-600 max-w-xs" },
                                                    React.createElement('div', { className: "truncate", title: item.image_url },
                                                        React.createElement('a', { href: item.image_url, target: "_blank", rel: "noopener noreferrer", className: "hover:underline" }, item.image_url)
                                                    )
                                                ),
                                                React.createElement('td', { className: "px-3 py-4 text-sm text-blue-600 max-w-xs" },
                                                    React.createElement('div', { className: "truncate", title: item.website_url },
                                                        React.createElement('a', { href: item.website_url, target: "_blank", rel: "noopener noreferrer", className: "hover:underline" }, item.website_url)
                                                    )
                                                ),
                                                React.createElement('td', { className: "px-3 py-4 whitespace-nowrap text-sm text-gray-900" }, item.location.section),
                                                React.createElement('td', { className: "px-3 py-4 whitespace-nowrap text-sm text-gray-900" }, item.location.stand_name),
                                                React.createElement('td', { className: "px-3 py-4 text-sm text-gray-900" },
                                                    React.createElement('div', { className: "space-y-1" },
                                                        item.dietary_info.allergens.length > 0 && React.createElement('div', { className: "text-red-600 text-xs" }, `Allergens: ${item.dietary_info.allergens.join(', ')}`),
                                                        item.dietary_info.dietary_tags.length > 0 && React.createElement('div', { className: "text-green-600 text-xs" }, item.dietary_info.dietary_tags.join(', '))
                                                    )
                                                ),
                                                React.createElement('td', { className: "px-3 py-4 whitespace-nowrap text-sm text-gray-900" }, `$${item.pricing.average_price}`),
                                                React.createElement('td', { className: "px-3 py-4 whitespace-nowrap text-sm text-gray-900" }, `${item.popularity.popularity_score}/10`),
                                                React.createElement('td', { className: "px-3 py-4 whitespace-nowrap text-sm text-gray-900" }, item.speed_metadata.estimated_wait),
                                                React.createElement('td', { className: "px-3 py-4 text-sm text-gray-900" },
                                                    React.createElement('div', { className: "flex flex-wrap gap-1" },
                                                        item.custom_tags.map((tag, tagIndex) =>
                                                            React.createElement('span', {
                                                                key: tagIndex,
                                                                className: "px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs"
                                                            }, tag)
                                                        )
                                                    )
                                                ),
                                                React.createElement('td', { className: "px-3 py-4 whitespace-nowrap text-sm text-gray-900" }, item.start_date),
                                                React.createElement('td', { className: "px-3 py-4 whitespace-nowrap text-sm text-gray-900" }, item.end_date)
                                            )
                                        )
                                    )
                                )
                            ) :
                            React.createElement('div', { className: "text-center py-8 text-gray-500" },
                                "No results found for your query. Try adjusting your search terms."
                            )
                    )
                ),

                // Default state
                !queryResults && React.createElement('div', { className: "bg-white rounded-lg shadow-md p-8 text-center" },
                    React.createElement('div', { className: "w-12 h-12 text-gray-400 mx-auto mb-4" },
                        React.createElement(Search)
                    ),
                    React.createElement('h3', { className: "text-lg font-medium text-gray-900 mb-2" }, "Ready to Search"),
                    React.createElement('p', { className: "text-gray-600" },
                        "Enter a query above to see how it gets processed into filters and results"
                    )
                )
            );
        };

        // Mount the component
        try {
            ReactDOM.render(React.createElement(FoodQueryPrototype), document.getElementById('root'));
        } catch (error) {
            console.error('Error rendering component:', error);
            document.getElementById('root').innerHTML = '<div style="padding: 20px; color: red;">Error loading prototype. Please refresh the page.</div>';
        }
    </script>
</body>
</html>
